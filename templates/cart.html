{% extends 'base.html' %}
{% block content %}
<h2 class="section-title">Cart</h2>
{% if items and items|length > 0 %}
<table class="table">
    <tr><th>Product</th><th>Qty</th><th>Price</th><th>Subtotal</th><th>Action</th></tr>
    {% for it in items %}
    <tr>
        <td>{{ it.name }}</td>
        <td>{{ it.qty }}</td>
        <td>₹{{ '%.2f'|format(it.price) }}</td>
        <td>₹{{ '%.2f'|format(it.subtotal) }}</td>
        <td>
            <form method="post" action="{{ url_for('cart_remove') }}">
                <input type="hidden" name="product_id" value="{{ it.id }}">
                <button class="btn btn-danger" type="submit">Remove</button>
            </form>
        </td>
    </tr>
    {% endfor %}
    <tr>
        <td colspan="3" class="invoice-total">Total</td>
        <td class="invoice-total">₹{{ '%.2f'|format(total) }}</td>
        <td></td>
    </tr>
</table>
<div class="actions">
    <a class="btn btn-outline" href="{{ url_for('index') }}">Continue Shopping</a>
    <form method="post" action="{{ url_for('cart_clear') }}">
        <button class="btn btn-outline" type="submit">Clear Cart</button>
    </form>
</div>
<form method="post" action="{{ url_for('cart_checkout') }}" class="form" style="margin-top:12px">
    <div class="grid" style="grid-template-columns:repeat(2,1fr);gap:12px">
        <div class="field"><label>Door No</label><input name="door_no" required></div>
        <div class="field"><label>Street</label><input name="street" required></div>
        <div class="field"><label>Landmark</label><input name="landmark"></div>
        <div class="field"><label>Place</label><input name="place" required></div>
        <div class="field"><label>District</label><input name="district" required></div>
        <div class="field"><label>State</label><input name="state" required></div>
        <div class="field"><label>Alternative Mobile No</label><input name="alt_mobile" pattern="[0-9]{10}"></div>
        <div class="field"><label>Pincode</label><input name="pincode" pattern="[0-9]{6}" required></div>
    </div>
    <div class="actions"><button class="btn" type="submit">Order Now</button></div>
</form>
{% else %}
<p class="meta">Your cart is empty.</p>
<a class="btn" href="{{ url_for('index') }}">Browse Products</a>
{% endif %}
{% endblock %}